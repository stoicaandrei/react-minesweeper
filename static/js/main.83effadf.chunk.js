(this["webpackJsonpreact-minesweeper"]=this["webpackJsonpreact-minesweeper"]||[]).push([[0],{10:function(e,t,n){"use strict";var r=n(94);n.o(r,"boardSelectors")&&n.d(t,"boardSelectors",(function(){return r.boardSelectors})),n.o(r,"initBoard")&&n.d(t,"initBoard",(function(){return r.initBoard})),n.o(r,"resetBoard")&&n.d(t,"resetBoard",(function(){return r.resetBoard})),n.o(r,"triggerFlag")&&n.d(t,"triggerFlag",(function(){return r.triggerFlag})),n.o(r,"triggerReveal")&&n.d(t,"triggerReveal",(function(){return r.triggerReveal}))},100:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(50),a=n(16),c=n(25),o=n.n(c),i=n(12),s=n(127),u=n(128),l=n(27),f=n(11),d=n(64),b=n(129),v=n(45),p=n(61),g=n(38),h=n(6),m=function(){function e(){var t=this;Object(s.a)(this,e),this.sockets=void 0,this.timeouts=void 0,this.pingInterval=void 0,this.logging=void 0,this.handleMessage=void 0,this.handleOpen=void 0,this.handleClose=void 0,this.handleReconnect=void 0,this.socketEvents=void 0,this.sagaEffects=[],this._ping=function(e){t.sockets[e].socket.send(h.a),t.timeouts[e]=setTimeout((function(){t.sockets[e].socket.close(4008,"ping_timeout")}),h.d)},this._onPong=function(e){clearTimeout(t.timeouts[e])},this._listen=function(e){var n=t.sockets[e].socket;n.onopen=function(n){t.pingInterval=setInterval((function(){return t._ping(e)}),h.b),t._log(n,e),t.handleOpen(e)},n.onclose=function(n){if(clearInterval(t.pingInterval),console.log(t.sockets),!n.wasClean){var r=t.sockets[e],a=r.token,c=r.uri;setTimeout((function(){return t.connectToSocket(e,a,c)}),1e4)}t.handleClose(e,n.wasClean),t._log(n,e)},n.onmessage=function(n){n.data===h.c?t._onPong(e):(t.handleMessage(e,JSON.parse(n.data)),t._log(n,e))}},this._log=function(e,n){t.logging&&console.log({event:e,state:t.getState(n),socketObj:t.sockets})},this.getState=function(e){return h.n[t.sockets[e].socket.readyState]},this.connectToSocket=function(e,n,r){if(!t.sockets[e]||h.n[t.sockets[e].socket.readyState]!==h.j){var a=new WebSocket("".concat(p.b).concat(r,"?token=").concat(n));t.sockets[e]={token:n,uri:r,socket:a},t._listen(e)}},this.disconnectFromSocket=function(e){console.log(t.sockets),t.sockets[e].socket.close()},this.onOpen=function(e){t.handleOpen=e},this.onReconnect=function(e){t.handleReconnect=e},this.onMessage=function(e){t.handleMessage=e},this.onClose=function(e){t.handleClose=e},this.sockets={},this.timeouts={},this.pingInterval=null,this.logging=!0,this.handleMessage=function(e){return console.log(e)},this.handleOpen=function(e){return console.log(e)},this.handleClose=function(e){return console.log(e)},this.handleReconnect=function(e){return console.log(e)},this.socketEvents={}}return Object(u.a)(e,[{key:"createModule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.initialState,r=t.single;n||(n=r?{item:{}}:{items:[]},n=Object(i.a)(Object(i.a)({},n),{},{waiting:!1})),this.socketEvents[e]={reducer:Object(b.reducerWithInitialState)(n),events:{}}}},{key:"createLocalEvent",value:function(e,t,n){var r=Object(d.actionCreatorFactory)(e)(t);return this.socketEvents[e].reducer.case(r,(function(e,t){return Object(v.a)(e,(function(e){n(e,t)}))})),r}},{key:"createApi",value:function(e,t,n){var r=Object(d.actionCreatorFactory)(e).async(t);this.sagaEffects.push(Object(l.d)(r.started,o.a.mark((function t(a){var c,s,u,f;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.c)((function(e){return e.auth.item.token}));case 3:return c=t.sent,t.next=6,Object(l.c)((function(e){var t,n;return null===(t=e.session.item)||void 0===t||null===(n=t.session)||void 0===n?void 0:n.id}));case 6:return s=t.sent,t.next=9,Object(l.a)((function(){return Object(g.apiCaller)(Object(i.a)(Object(i.a)({endpoint:e},n),{},{data:a.payload,token:c,session_id:s}))}));case 9:if(u=t.sent,f=u.result,"2"===u.status.toString()[0]){t.next=17;break}return console.log(f),t.next=16,Object(l.b)(r.failed({params:a.payload,error:f}));case 16:return t.abrupt("return",t.sent);case 17:return t.next=19,Object(l.b)(r.done({params:a.payload,result:f}));case 19:t.next=26;break;case 21:return t.prev=21,t.t0=t.catch(0),console.log(t.t0),t.next=26,Object(l.b)(r.failed({params:a.payload,error:t.t0}));case 26:case"end":return t.stop()}}),t,null,[[0,21]])}))));var a=this.socketEvents[e].reducer;return a.case(r.started,(function(e,t){return Object(v.a)(e,(function(e){e.waiting=!0,e.error=void 0,n.startReducer&&n.startReducer(e,t)}))})),a.case(r.failed,(function(e,t){var r=t.params,a=t.error;return Object(v.a)(e,(function(e){e.waiting=!1,e.error=a,n.failReducer&&n.failReducer(e,a,r)}))})),a.case(r.done,(function(e,t){var r=t.params,a=t.result;return Object(v.a)(e,(function(e){e.waiting=!1,n.successReducer(e,a,r)}))})),function(e){return r.started(e)}}},{key:"createSocketListener",value:function(e,t,n){var r=Object(d.actionCreatorFactory)(e)(t),a=this.socketEvents[e].reducer;this.socketEvents[e].events[t]=r,a.case(r,(function(e,t){return Object(v.a)(e,(function(e){n(e,t)}))}))}},{key:"events",get:function(){return this.socketEvents}},{key:"reducer",get:function(){var e={};return Object.entries(this.socketEvents).forEach((function(t){var n=Object(a.a)(t,2),r=n[0],c=n[1];e[r]=c.reducer})),Object(f.combineReducers)(e)}},{key:"saga",get:function(){var e=this;return o.a.mark((function t(){var n,a,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(r.a)(e.sagaEffects),t.prev=1,n.s();case 3:if((a=n.n()).done){t.next=9;break}return c=a.value,t.next=7,c;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])}))}}]),e}()},101:function(e,t,n){"use strict"},102:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(16),a=n(6);function c(e){return function(t){return function(n){return function(c){var o,i,s;if(c.meta!==a.f)return n(c);switch(o=n(c),c.type){case a.g:e.onOpen((function(e){t.dispatch({type:a.h,meta:a.f,socketDesc:e})})),e.onClose((function(e,n){console.log("closing ",e,n),t.dispatch({type:a.e,meta:a.f,socketDesc:e,wasClean:n})})),e.onMessage((function(e,n){t.dispatch({type:a.k,payload:n,meta:a.f,socketDesc:e})})),e.onReconnect((function(e){t.dispatch({type:a.l,meta:a.f,socketDesc:e})})),e.connectToSocket(c.socketDesc,c.token,c.uri);break;case a.i:console.log("disconecting "),e.disconnectFromSocket(c.socketDesc);break;case a.k:var u=c.payload.type.split("."),l=Object(r.a)(u,2);i=l[0],s=l[1],e.events.hasOwnProperty(i)&&e.events[i].events.hasOwnProperty(s)?t.dispatch(e.events[i].events[s](c.payload.data)):console.warn({module:i,event:s},"does not exist");break;case a.l:t.dispatch({type:a.m,meta:a.f,socketDesc:c.socketDesc})}return o}}}}},103:function(e,t){},104:function(e,t){},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return d}));var r=n(18),a=n(16),c=n(50);function o(e,t){for(var n=e.x,r=e.y,a=[],c=-1;c<=1;c++)for(var o=-1;o<=1;o++){var i=n+c,s=r+o;t[i]&&t[i][s]&&a.push(t[i][s])}return a}function i(e,t){e.is_revealed||e.is_flagged||(e.is_revealed=!0,e.is_bomb&&function(e){e.cells.forEach((function(e){e.forEach((function(e){e.is_revealed=!0}))}))}(t),e.value||o(e,t.cells).map((function(e){return i(e,t)})))}function s(e,t,n,r){r.status="playing",r.cells=[];for(var c=0;c<e;c++){r.cells.push([]),r.startTime=new Date;for(var i=0;i<t;i++)r.cells[c].push({is_revealed:!1,is_bomb:!1,is_flagged:!1,value:0,x:c,y:i})}for(var s=[],u=0;u<e;u++)for(var l=0;l<t;l++)s.push([u,l]);function f(e){var t=Math.floor(Math.random()*e.length),n=e[t];return e.splice(t,1),n}for(var d=0;d<n;d++){if(!s.length)return;var b=f(s),v=Object(a.a)(b,2),p=v[0],g=v[1];r.cells[p][g].is_bomb=!0,o(r.cells[p][g],r.cells).forEach((function(e){return e.is_bomb?null:e.value+=1}))}}r.a.createModule("board",{initialState:{cells:[]}});var u=r.a.createLocalEvent("board","INIT_BOARD",(function(e,t){var n=t.cols,r=t.rows,a=t.bombs,c=t.difficulty;e.rows=r,e.cols=n,e.bombs=a,e.difficulty=c,s(r,n,a,e)})),l=r.a.createLocalEvent("board","RESET_BOARD",(function(e){s(e.rows,e.cols,e.bombs,e)})),f=r.a.createLocalEvent("board","TRIGGER_REVEAL",(function(e,t){var n=t.x,r=t.y,a=e.cells[n][r];a.is_revealed?function(e,t){return o(e,t).reduce((function(e,t){return t.is_flagged?e+1:e}),0)}(a,e.cells)===a.value&&o(a,e.cells).forEach((function(t){return i(t,e)})):i(a,e),function(e){var t,n=Object(c.a)(e.cells);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,o=Object(c.a)(a);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.is_revealed&&i.is_bomb)return e.status="lost";if(!i.is_revealed&&!i.is_bomb)return e.status="playing"}}catch(s){o.e(s)}finally{o.f()}}}catch(s){n.e(s)}finally{n.f()}e.status="won"}(e)})),d=r.a.createLocalEvent("board","TRIGGER_FLAG",(function(e,t){var n=t.x,r=t.y,a=e.cells[n][r];a.is_revealed||(a.is_flagged=!a.is_flagged)}))},144:function(e,t,n){e.exports=n(235)},18:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=new(n(38).StateManager)},235:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(8),o=n.n(c),i=n(9),s=n(60),u=(n(153),n(240)),l=n(12),f=n(19),d=n(86),b=n.n(d),v=Object(f.a)();v.location=Object(l.a)(Object(l.a)({},v.location),{},{query:b.a.parse(v.location.search.substr(1)),state:{}}),v.listen((function(){v.location=Object(l.a)(Object(l.a)({},v.location),{},{query:b.a.parse(v.location.search.substr(1)),state:v.location.state||{}})}));v.go,v.goBack,v.push,v.replace;var p,g=v,h=n(241),m=n(238),O=n(16),E=n(239),k=n(242),j=n(10),y=Object(r.memo)((function(e){var t=e.cell,n=e.disabled,r=Object(i.b)();return a.a.createElement(m.a,{type:t.is_revealed?"primary":void 0,danger:t.is_revealed&&t.is_bomb,style:{height:30,width:30,borderRadius:0},onMouseDown:function(e){e.preventDefault(),n||0===e.button&&r(Object(j.triggerReveal)(t))},onContextMenu:function(e){e.preventDefault(),n||r(Object(j.triggerFlag)(t))}},t.is_revealed?t.is_bomb?"B":t.value?t.value:" ":t.is_flagged?"F":" ")})),S=function(){var e=Object(i.b)(),t=Object(i.c)(j.boardSelectors.board),n=Object(i.c)(j.boardSelectors.gameStatus),c=Object(i.c)(j.boardSelectors.bombsLeft),o=Object(i.c)(j.boardSelectors.startTime),s=Object(r.useState)(0),u=Object(O.a)(s,2),l=u[0],f=u[1];return Object(r.useEffect)((function(){var e=setInterval((function(){return f((function(e){return e+1}))}),1e3);return function(){clearInterval(e)}}),[e]),Object(r.useEffect)((function(){"won"===n&&E.a.info("You won! :)"),"lost"===n&&E.a.error("You lost! :(")}),[n]),Object(r.useEffect)((function(){f(0)}),[o]),a.a.createElement("div",null,a.a.createElement(h.a,null,"Bombs left: ",c),a.a.createElement(h.a,null,"Time: ",String(l).padStart(3,"0")),a.a.createElement("div",{style:{border:"2px solid black"}},t.cells.map((function(e,t){return a.a.createElement(h.a,{key:t,style:{flexWrap:"nowrap"},justify:"start"},e.map((function(e,t){return a.a.createElement(k.a,{key:t},a.a.createElement(y,{cell:e,disabled:"playing"!==n}))})))}))))},w=n(43),_={rows:10,cols:10,bombs:10,difficulty:"Easy"},C={rows:16,cols:16,bombs:40,difficulty:"Intermediate"},T={rows:16,cols:30,bombs:99,difficulty:"Expert"},M=(p={},Object(w.a)(p,_.difficulty,_),Object(w.a)(p,C.difficulty,C),Object(w.a)(p,T.difficulty,T),p),R=function(){var e=Object(i.b)(),t=Object(i.c)(j.boardSelectors.difficulty),n=Object(r.useState)(t),c=Object(O.a)(n,2),o=c[0],s=c[1];return a.a.createElement("div",null,Object.keys(M).map((function(t){return a.a.createElement(m.a,{key:t,onClick:function(){s(t),e(Object(j.initBoard)(M[t]))},type:t===o?"primary":void 0},t)})))},x=function(){var e=Object(i.b)(),t=Object(i.c)(j.boardSelectors.board).cols;Object(r.useEffect)((function(){e(Object(j.initBoard)(_))}),[e]);var n=function(e){return a.a.createElement(h.a,{justify:e.justifyStart?"start":"center",style:{textAlign:"center",paddingTop:e.paddingTop}},e.children)};return a.a.createElement("div",null,a.a.createElement(n,{paddingTop:30},a.a.createElement("h1",null,"Minesweeper")),a.a.createElement(n,{paddingTop:10},a.a.createElement(m.a,{onClick:function(){return e(Object(j.resetBoard)({}))}},"Reset")),a.a.createElement(n,{paddingTop:0,justifyStart:window.innerWidth<500&&t>10},a.a.createElement(S,null)),a.a.createElement(n,{paddingTop:10},a.a.createElement(R,null)))},N=function(){return a.a.createElement(u.a,{history:g},a.a.createElement(s.a,{defer:!1,htmlAttributes:{lang:"en"},encodeSpecialCharacters:!0,defaultTitle:"Minesweeper",titleTemplate:"%s | PM",titleAttributes:{itemprop:"name",lang:"en"}},a.a.createElement("style",null,"body { background-color: #f0f2f5; }")),a.a.createElement(x,null))};N.defaultProps={};var D=N;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var I=n(11),B=n(140),F=n(142),G=n(18),L=n(38),K=Object(F.a)(),A=Object(I.compose)(Object(I.applyMiddleware)(Object(L.createSocketMiddleware)(G.a)),Object(I.applyMiddleware)(K),Object(B.devToolsEnhancer)({})),P=Object(I.createStore)(G.a.reducer,A);K.run(G.a.saga),o.a.render(a.a.createElement(i.a,{store:P},a.a.createElement(s.b,null,a.a.createElement(D,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},38:function(e,t,n){"use strict";n(96);var r=n(97);n.o(r,"StateManager")&&n.d(t,"StateManager",(function(){return r.StateManager})),n.o(r,"apiCaller")&&n.d(t,"apiCaller",(function(){return r.apiCaller})),n.o(r,"createSocketMiddleware")&&n.d(t,"createSocketMiddleware",(function(){return r.createSocketMiddleware}))},6:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"n",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return d})),n.d(t,"l",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return g}));var r=1e4,a=5e3,c="PING",o="PONG",i="SOCKET_OPENED",s="SOCKET_CLOSED",u={0:"SOCKET_CONNECTING",1:i,2:"SOCKET_CLOSING",3:s},l="SOCKET_COMMAND",f="SOCKET_RECEIVE",d="SOCKET_RECONNECTED",b="SOCKET_RECONNECT",v="SOCKET_CONNECT",p="SOCKET_CONNECTED",g="SOCKET_DISCONNECT"},61:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="",a="";r="http://".concat("","/api"),a="ws://".concat("","/api")},94:function(e,t,n){"use strict";var r=n(95);n.d(t,"boardSelectors",(function(){return r}));var a=n(121);n.d(t,"initBoard",(function(){return a.a})),n.d(t,"resetBoard",(function(){return a.b})),n.d(t,"triggerFlag",(function(){return a.c})),n.d(t,"triggerReveal",(function(){return a.d}));n(104)},95:function(e,t,n){"use strict";n.r(t),n.d(t,"board",(function(){return r})),n.d(t,"gameStatus",(function(){return a})),n.d(t,"startTime",(function(){return c})),n.d(t,"difficulty",(function(){return o})),n.d(t,"bombsLeft",(function(){return i}));var r=function(e){return e.board},a=function(e){return e.board.status},c=function(e){return e.board.startTime},o=function(e){return e.board.difficulty},i=function(e){var t=e.board.cells.flat(1);return e.board.bombs-t.reduce((function(e,t){return t.is_flagged?e+1:e}),0)}},96:function(e,t,n){"use strict";n(0)},97:function(e,t,n){"use strict";var r=n(98);n.d(t,"apiCaller",(function(){return r.a}));var a=n(100);n.d(t,"StateManager",(function(){return a.a}));n(101);var c=n(102);n.d(t,"createSocketMiddleware",(function(){return c.a}));n(103)},98:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(25),a=n.n(r),c=n(12),o=n(125),i=n(126),s=n.n(i),u=n(61);function l(e){return f.apply(this,arguments)}function f(){return(f=Object(o.a)(a.a.mark((function e(t){var n,r,o,i,l,f,d,b,v,p,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.path,r=t.method,o=void 0===r?"GET":r,i=t.data,l=t.token,f=t.session_id,d=t.endpoint,f&&(i=Object(c.a)(Object(c.a)({},i),{},{session_id:f})),b="?"+s.a.stringify(i||{}),(v="".concat(u.a,"/").concat(d).concat(n)).endsWith("/")||(v+="/"),"GET"===o&&(v+=b),n.split("/").filter((function(e){return":"===e[0]})).forEach((function(e){var t=e.slice(1);v=v.replace(e,i[t]),i[t]=void 0})),(p=new Headers).append("Content-Type","application/json"),l&&p.append("Authorization","JWT ".concat(l)),e.next=13,fetch(v,{headers:p,method:o,body:"GET"!==o?JSON.stringify(i):void 0});case 13:return g=e.sent,e.prev=14,e.next=17,g.json();case 17:return e.t0=e.sent,e.t1=g.status,e.abrupt("return",{result:e.t0,status:e.t1});case 22:return e.prev=22,e.t2=e.catch(14),e.abrupt("return",{result:e.t2,status:g.status});case 25:case"end":return e.stop()}}),e,null,[[14,22]])})))).apply(this,arguments)}}},[[144,1,2]]]);
//# sourceMappingURL=main.83effadf.chunk.js.map