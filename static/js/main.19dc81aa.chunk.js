(this["webpackJsonpreact-fc-ts-redux-saga-boilerplate"]=this["webpackJsonpreact-fc-ts-redux-saga-boilerplate"]||[]).push([[0],{14:function(e,t,n){"use strict";n(36);var c=n(37);n.o(c,"StateManager")&&n.d(t,"StateManager",(function(){return c.StateManager})),n.o(c,"apiCaller")&&n.d(t,"apiCaller",(function(){return c.apiCaller})),n.o(c,"createSocketMiddleware")&&n.d(t,"createSocketMiddleware",(function(){return c.createSocketMiddleware}))},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));var c="",a="";c="http://".concat("","/api"),a="ws://".concat("","/api")},36:function(e,t,n){"use strict";n(1)},37:function(e,t,n){"use strict";var c=n(38);n.d(t,"apiCaller",(function(){return c.a}));var a=n(40);n.d(t,"StateManager",(function(){return a.a}));n(41);var r=n(42);n.d(t,"createSocketMiddleware",(function(){return r.a}));n(43)},38:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var c=n(12),a=n.n(c),r=n(8),o=n(49),s=n(50),i=n.n(s),u=n(21);function l(e){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(a.a.mark((function e(t){var n,c,o,s,l,d,f,p,h,v,k;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.path,c=t.method,o=void 0===c?"GET":c,s=t.data,l=t.token,d=t.session_id,f=t.endpoint,d&&(s=Object(r.a)(Object(r.a)({},s),{},{session_id:d})),p="?"+i.a.stringify(s||{}),(h="".concat(u.a,"/").concat(f).concat(n)).endsWith("/")||(h+="/"),"GET"===o&&(h+=p),n.split("/").filter((function(e){return":"===e[0]})).forEach((function(e){var t=e.slice(1);h=h.replace(e,s[t]),s[t]=void 0})),(v=new Headers).append("Content-Type","application/json"),l&&v.append("Authorization","JWT ".concat(l)),e.next=13,fetch(h,{headers:v,method:o,body:"GET"!==o?JSON.stringify(s):void 0});case 13:return k=e.sent,e.prev=14,e.next=17,k.json();case 17:return e.t0=e.sent,e.t1=k.status,e.abrupt("return",{result:e.t0,status:e.t1});case 22:return e.prev=22,e.t2=e.catch(14),e.abrupt("return",{result:e.t2,status:k.status});case 25:case"end":return e.stop()}}),e,null,[[14,22]])})))).apply(this,arguments)}},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var c=n(51),a=n(22),r=n(12),o=n.n(r),s=n(8),i=n(52),u=n(53),l=n(13),d=n(7),f=n(24),p=n(54),h=n(15),v=n(21),k=n(14),g=n(6),O=function(){function e(){var t=this;Object(i.a)(this,e),this.sockets=void 0,this.timeouts=void 0,this.pingInterval=void 0,this.logging=void 0,this.handleMessage=void 0,this.handleOpen=void 0,this.handleClose=void 0,this.handleReconnect=void 0,this.socketEvents=void 0,this.sagaEffects=[],this._ping=function(e){t.sockets[e].socket.send(g.a),t.timeouts[e]=setTimeout((function(){t.sockets[e].socket.close(4008,"ping_timeout")}),g.d)},this._onPong=function(e){clearTimeout(t.timeouts[e])},this._listen=function(e){var n=t.sockets[e].socket;n.onopen=function(n){t.pingInterval=setInterval((function(){return t._ping(e)}),g.b),t._log(n,e),t.handleOpen(e)},n.onclose=function(n){if(clearInterval(t.pingInterval),console.log(t.sockets),!n.wasClean){var c=t.sockets[e],a=c.token,r=c.uri;setTimeout((function(){return t.connectToSocket(e,a,r)}),1e4)}t.handleClose(e,n.wasClean),t._log(n,e)},n.onmessage=function(n){n.data===g.c?t._onPong(e):(t.handleMessage(e,JSON.parse(n.data)),t._log(n,e))}},this._log=function(e,n){t.logging&&console.log({event:e,state:t.getState(n),socketObj:t.sockets})},this.getState=function(e){return g.n[t.sockets[e].socket.readyState]},this.connectToSocket=function(e,n,c){if(!t.sockets[e]||g.n[t.sockets[e].socket.readyState]!==g.j){var a=new WebSocket("".concat(v.b).concat(c,"?token=").concat(n));t.sockets[e]={token:n,uri:c,socket:a},t._listen(e)}},this.disconnectFromSocket=function(e){console.log(t.sockets),t.sockets[e].socket.close()},this.onOpen=function(e){t.handleOpen=e},this.onReconnect=function(e){t.handleReconnect=e},this.onMessage=function(e){t.handleMessage=e},this.onClose=function(e){t.handleClose=e},this.sockets={},this.timeouts={},this.pingInterval=null,this.logging=!0,this.handleMessage=function(e){return console.log(e)},this.handleOpen=function(e){return console.log(e)},this.handleClose=function(e){return console.log(e)},this.handleReconnect=function(e){return console.log(e)},this.socketEvents={}}return Object(u.a)(e,[{key:"createModule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.initialState,c=t.single;n||(n=c?{item:{}}:{items:[]},n=Object(s.a)(Object(s.a)({},n),{},{waiting:!1})),this.socketEvents[e]={reducer:Object(p.reducerWithInitialState)(n),events:{}}}},{key:"createLocalEvent",value:function(e,t,n){var c=Object(f.actionCreatorFactory)(e)(t);return this.socketEvents[e].reducer.case(c,(function(e,t){return Object(h.a)(e,(function(e){n(e,t)}))})),c}},{key:"createApi",value:function(e,t,n){var c=Object(f.actionCreatorFactory)(e).async(t);this.sagaEffects.push(Object(l.d)(c.started,o.a.mark((function t(a){var r,i,u,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.c)((function(e){return e.auth.item.token}));case 3:return r=t.sent,t.next=6,Object(l.c)((function(e){var t,n;return null===(t=e.session.item)||void 0===t||null===(n=t.session)||void 0===n?void 0:n.id}));case 6:return i=t.sent,t.next=9,Object(l.a)((function(){return Object(k.apiCaller)(Object(s.a)(Object(s.a)({endpoint:e},n),{},{data:a.payload,token:r,session_id:i}))}));case 9:if(u=t.sent,d=u.result,"2"===u.status.toString()[0]){t.next=17;break}return console.log(d),t.next=16,Object(l.b)(c.failed({params:a.payload,error:d}));case 16:return t.abrupt("return",t.sent);case 17:return t.next=19,Object(l.b)(c.done({params:a.payload,result:d}));case 19:t.next=26;break;case 21:return t.prev=21,t.t0=t.catch(0),console.log(t.t0),t.next=26,Object(l.b)(c.failed({params:a.payload,error:t.t0}));case 26:case"end":return t.stop()}}),t,null,[[0,21]])}))));var a=this.socketEvents[e].reducer;return a.case(c.started,(function(e,t){return Object(h.a)(e,(function(e){e.waiting=!0,e.error=void 0,n.startReducer&&n.startReducer(e,t)}))})),a.case(c.failed,(function(e,t){var c=t.params,a=t.error;return Object(h.a)(e,(function(e){e.waiting=!1,e.error=a,n.failReducer&&n.failReducer(e,a,c)}))})),a.case(c.done,(function(e,t){var c=t.params,a=t.result;return Object(h.a)(e,(function(e){e.waiting=!1,n.successReducer(e,a,c)}))})),function(e){return c.started(e)}}},{key:"createSocketListener",value:function(e,t,n){var c=Object(f.actionCreatorFactory)(e)(t),a=this.socketEvents[e].reducer;this.socketEvents[e].events[t]=c,a.case(c,(function(e,t){return Object(h.a)(e,(function(e){n(e,t)}))}))}},{key:"events",get:function(){return this.socketEvents}},{key:"reducer",get:function(){var e={};return Object.entries(this.socketEvents).forEach((function(t){var n=Object(a.a)(t,2),c=n[0],r=n[1];e[c]=r.reducer})),Object(d.combineReducers)(e)}},{key:"saga",get:function(){var e=this;return o.a.mark((function t(){var n,a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(c.a)(e.sagaEffects),t.prev=1,n.s();case 3:if((a=n.n()).done){t.next=9;break}return r=a.value,t.next=7,r;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])}))}}]),e}()},41:function(e,t,n){"use strict"},42:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var c=n(22),a=n(6);function r(e){return function(t){return function(n){return function(r){var o,s,i;if(r.meta!==a.f)return n(r);switch(o=n(r),r.type){case a.g:e.onOpen((function(e){t.dispatch({type:a.h,meta:a.f,socketDesc:e})})),e.onClose((function(e,n){console.log("closing ",e,n),t.dispatch({type:a.e,meta:a.f,socketDesc:e,wasClean:n})})),e.onMessage((function(e,n){t.dispatch({type:a.k,payload:n,meta:a.f,socketDesc:e})})),e.onReconnect((function(e){t.dispatch({type:a.l,meta:a.f,socketDesc:e})})),e.connectToSocket(r.socketDesc,r.token,r.uri);break;case a.i:console.log("disconecting "),e.disconnectFromSocket(r.socketDesc);break;case a.k:var u=r.payload.type.split("."),l=Object(c.a)(u,2);s=l[0],i=l[1],e.events.hasOwnProperty(s)&&e.events[s].events.hasOwnProperty(i)?t.dispatch(e.events[s].events[i](r.payload.data)):console.warn({module:s,event:i},"does not exist");break;case a.l:t.dispatch({type:a.m,meta:a.f,socketDesc:r.socketDesc})}return o}}}}},43:function(e,t){},57:function(e,t,n){e.exports=n(85)},6:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"n",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return k}));var c=1e4,a=5e3,r="PING",o="PONG",s="SOCKET_OPENED",i="SOCKET_CLOSED",u={0:"SOCKET_CONNECTING",1:s,2:"SOCKET_CLOSING",3:i},l="SOCKET_COMMAND",d="SOCKET_RECEIVE",f="SOCKET_RECONNECTED",p="SOCKET_RECONNECT",h="SOCKET_CONNECT",v="SOCKET_CONNECTED",k="SOCKET_DISCONNECT"},85:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(17),o=n.n(r),s=n(55),i=n(20),u=(n(66),n(87)),l=n(8),d=n(11),f=n(28),p=n.n(f),h=Object(d.a)();h.location=Object(l.a)(Object(l.a)({},h.location),{},{query:p.a.parse(h.location.search.substr(1)),state:{}}),h.listen((function(){h.location=Object(l.a)(Object(l.a)({},h.location),{},{query:p.a.parse(h.location.search.substr(1)),state:h.location.state||{}})}));h.go,h.goBack,h.push,h.replace;var v=h,k=function(){return a.a.createElement("div",null,"Test")},g=function(){return a.a.createElement(u.a,{history:v},a.a.createElement(i.a,{defer:!1,htmlAttributes:{lang:"en"},encodeSpecialCharacters:!0,defaultTitle:"Minesweeper",titleTemplate:"%s | PM",titleAttributes:{itemprop:"name",lang:"en"}}),a.a.createElement(k,null))};g.defaultProps={};var O=g;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var b=n(7),m=n(48),E=n(56),j=n(14),C=new j.StateManager,y=Object(E.a)(),S=Object(b.compose)(Object(b.applyMiddleware)(Object(j.createSocketMiddleware)(C)),Object(b.applyMiddleware)(y),Object(m.devToolsEnhancer)({})),w=Object(b.createStore)(C.reducer,S);y.run(C.saga),o.a.render(a.a.createElement(s.a,{store:w},a.a.createElement(i.b,null,a.a.createElement(O,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.19dc81aa.chunk.js.map