(this["webpackJsonpreact-minesweeper"]=this["webpackJsonpreact-minesweeper"]||[]).push([[0],{116:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d}));var r=n(15),a=n(23);function c(e,t){for(var n=e.x,r=e.y,a=[],c=-1;c<=1;c++)for(var o=-1;o<=1;o++){var s=n+c,i=r+o;t[s]&&t[s][i]&&a.push(t[s][i])}return a}function o(e,t){e.is_revealed||e.is_flagged||(e.is_revealed=!0,e.is_bomb&&function(e){e.cells.forEach((function(e){e.forEach((function(e){e.is_revealed=!0}))}))}(t),e.value||c(e,t.cells).map((function(e){return o(e,t)})))}function s(e,t,n,r){for(var o=0;o<e;o++){r.cells.push([]);for(var s=0;s<t;s++)r.cells[o].push({is_revealed:!1,is_bomb:!1,is_flagged:!1,value:0,x:o,y:s})}for(var i=[],u=0;u<e;u++)for(var l=0;l<t;l++)i.push([u,l]);function d(e){var t=Math.floor(Math.random()*e.length),n=e[t];return e.splice(t,1),n}for(var f=0;f<n;f++){if(!i.length)return;var v=d(i),p=Object(a.a)(v,2),b=p[0],h=p[1];r.cells[b][h].is_bomb=!0,c(r.cells[b][h],r.cells).forEach((function(e){return e.is_bomb?null:e.value+=1}))}}r.a.createModule("board",{initialState:{cells:[]}});var i=r.a.createLocalEvent("board","INIT_BOARD",(function(e,t){var n=t.cols,r=t.rows,a=t.bombs;e.rows=r,e.cols=n,e.bombs=a,e.cells=[],s(r,n,a,e)})),u=r.a.createLocalEvent("board","RESET_BOARD",(function(e){var t=e.rows,n=e.cols,r=e.bombs;e.cells=[],s(t,n,r,e)})),l=r.a.createLocalEvent("board","TRIGGER_REVEAL",(function(e,t){var n=t.x,r=t.y,a=e.cells[n][r];return a.is_revealed?function(e,t){return c(e,t).reduce((function(e,t){return t.is_flagged?e+1:e}),0)}(a,e.cells)===a.value?c(a,e.cells).forEach((function(t){return o(t,e)})):void 0:o(a,e)})),d=r.a.createLocalEvent("board","TRIGGER_FLAG",(function(e,t){var n=t.x,r=t.y,a=e.cells[n][r];a.is_revealed||(a.is_flagged=!a.is_flagged)}))},13:function(e,t,n){"use strict";var r=n(89);n.o(r,"boardSelectors")&&n.d(t,"boardSelectors",(function(){return r.boardSelectors})),n.o(r,"initBoard")&&n.d(t,"initBoard",(function(){return r.initBoard})),n.o(r,"resetBoard")&&n.d(t,"resetBoard",(function(){return r.resetBoard})),n.o(r,"triggerFlag")&&n.d(t,"triggerFlag",(function(){return r.triggerFlag})),n.o(r,"triggerReveal")&&n.d(t,"triggerReveal",(function(){return r.triggerReveal}))},138:function(e,t,n){e.exports=n(227)},15:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=new(n(37).StateManager)},227:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(17),o=n.n(c),s=n(11),i=n(52),u=(n(147),n(232)),l=n(9),d=n(16),f=n(79),v=n.n(f),p=Object(d.a)();p.location=Object(l.a)(Object(l.a)({},p.location),{},{query:v.a.parse(p.location.search.substr(1)),state:{}}),p.listen((function(){p.location=Object(l.a)(Object(l.a)({},p.location),{},{query:v.a.parse(p.location.search.substr(1)),state:p.location.state||{}})}));p.go,p.goBack,p.push,p.replace;var b=p,h=n(233),g=n(231),m=n(230),O=n(234),k=n(13),E=Object(r.memo)((function(e){var t=e.cell,n=Object(s.b)();return a.a.createElement(m.a,{type:t.is_revealed?"primary":void 0,danger:t.is_revealed&&t.is_bomb,style:{height:30,width:30,borderRadius:0},onMouseDown:function(e){e.preventDefault(),0===e.button&&n(Object(k.triggerReveal)(t))},onContextMenu:function(e){e.preventDefault(),n(Object(k.triggerFlag)(t))}},t.is_revealed?t.is_bomb?"B":t.value?t.value:" ":t.is_flagged?"F":" ")})),j=function(){Object(s.b)();var e=Object(s.c)(k.boardSelectors.board);return a.a.createElement("div",{style:{border:"2px solid black"}},e.cells.map((function(e,t){return a.a.createElement(h.a,{key:t},e.map((function(e,t){return a.a.createElement(O.a,{key:t},a.a.createElement(E,{cell:e}))})))})))},y=n(23),S={Easy:{rows:10,cols:10,bombs:10},Intermediate:{rows:16,cols:16,bombs:40},Expert:{rows:16,cols:30,bombs:99}},_=function(){var e=Object(s.b)(),t=Object(r.useState)("Easy"),n=Object(y.a)(t,2),c=n[0],o=n[1];return Object(r.useEffect)((function(){e(Object(k.initBoard)(S.Easy))}),[e]),a.a.createElement("div",null,Object.keys(S).map((function(t){return a.a.createElement(m.a,{key:t,onClick:function(){o(t),e(Object(k.initBoard)(S[t]))},type:t===c?"primary":void 0},t)})))},C=function(){var e=Object(s.b)(),t=function(e){return a.a.createElement(h.a,{justify:"center",style:{textAlign:"center",paddingTop:e.paddingTop}},e.children)};return a.a.createElement(g.a,{style:{height:"100vh"}},a.a.createElement(t,{paddingTop:30},a.a.createElement("h1",null,"Minesweeper")),a.a.createElement(t,{paddingTop:10},a.a.createElement(m.a,{onClick:function(){return e(Object(k.resetBoard)({}))}},"Reset")),a.a.createElement(t,{paddingTop:10},a.a.createElement(j,null)),a.a.createElement(t,{paddingTop:10},a.a.createElement(_,null)))},w=function(){return a.a.createElement(u.a,{history:b},a.a.createElement(i.a,{defer:!1,htmlAttributes:{lang:"en"},encodeSpecialCharacters:!0,defaultTitle:"Minesweeper",titleTemplate:"%s | PM",titleAttributes:{itemprop:"name",lang:"en"}}),a.a.createElement(C,null))};w.defaultProps={};var T=w;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var M=n(8),R=n(135),x=n(136),N=n(15),D=n(37),I=Object(x.a)(),B=Object(M.compose)(Object(M.applyMiddleware)(Object(D.createSocketMiddleware)(N.a)),Object(M.applyMiddleware)(I),Object(R.devToolsEnhancer)({})),F=Object(M.createStore)(N.a.reducer,B);I.run(N.a.saga),o.a.render(a.a.createElement(s.a,{store:F},a.a.createElement(i.b,null,a.a.createElement(T,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},37:function(e,t,n){"use strict";n(91);var r=n(92);n.o(r,"StateManager")&&n.d(t,"StateManager",(function(){return r.StateManager})),n.o(r,"apiCaller")&&n.d(t,"apiCaller",(function(){return r.apiCaller})),n.o(r,"createSocketMiddleware")&&n.d(t,"createSocketMiddleware",(function(){return r.createSocketMiddleware}))},53:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r="",a="";r="http://".concat("","/api"),a="ws://".concat("","/api")},6:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"e",(function(){return i})),n.d(t,"n",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return v})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return h}));var r=1e4,a=5e3,c="PING",o="PONG",s="SOCKET_OPENED",i="SOCKET_CLOSED",u={0:"SOCKET_CONNECTING",1:s,2:"SOCKET_CLOSING",3:i},l="SOCKET_COMMAND",d="SOCKET_RECEIVE",f="SOCKET_RECONNECTED",v="SOCKET_RECONNECT",p="SOCKET_CONNECT",b="SOCKET_CONNECTED",h="SOCKET_DISCONNECT"},89:function(e,t,n){"use strict";var r=n(90);n.d(t,"boardSelectors",(function(){return r}));var a=n(116);n.d(t,"initBoard",(function(){return a.a})),n.d(t,"resetBoard",(function(){return a.b})),n.d(t,"triggerFlag",(function(){return a.c})),n.d(t,"triggerReveal",(function(){return a.d}));n(99)},90:function(e,t,n){"use strict";n.r(t),n.d(t,"board",(function(){return r}));var r=function(e){return e.board}},91:function(e,t,n){"use strict";n(0)},92:function(e,t,n){"use strict";var r=n(93);n.d(t,"apiCaller",(function(){return r.a}));var a=n(95);n.d(t,"StateManager",(function(){return a.a}));n(96);var c=n(97);n.d(t,"createSocketMiddleware",(function(){return c.a}));n(98)},93:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(24),a=n.n(r),c=n(9),o=n(120),s=n(121),i=n.n(s),u=n(53);function l(e){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(a.a.mark((function e(t){var n,r,o,s,l,d,f,v,p,b,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.path,r=t.method,o=void 0===r?"GET":r,s=t.data,l=t.token,d=t.session_id,f=t.endpoint,d&&(s=Object(c.a)(Object(c.a)({},s),{},{session_id:d})),v="?"+i.a.stringify(s||{}),(p="".concat(u.a,"/").concat(f).concat(n)).endsWith("/")||(p+="/"),"GET"===o&&(p+=v),n.split("/").filter((function(e){return":"===e[0]})).forEach((function(e){var t=e.slice(1);p=p.replace(e,s[t]),s[t]=void 0})),(b=new Headers).append("Content-Type","application/json"),l&&b.append("Authorization","JWT ".concat(l)),e.next=13,fetch(p,{headers:b,method:o,body:"GET"!==o?JSON.stringify(s):void 0});case 13:return h=e.sent,e.prev=14,e.next=17,h.json();case 17:return e.t0=e.sent,e.t1=h.status,e.abrupt("return",{result:e.t0,status:e.t1});case 22:return e.prev=22,e.t2=e.catch(14),e.abrupt("return",{result:e.t2,status:h.status});case 25:case"end":return e.stop()}}),e,null,[[14,22]])})))).apply(this,arguments)}},95:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(122),a=n(23),c=n(24),o=n.n(c),s=n(9),i=n(123),u=n(124),l=n(26),d=n(8),f=n(56),v=n(125),p=n(38),b=n(53),h=n(37),g=n(6),m=function(){function e(){var t=this;Object(i.a)(this,e),this.sockets=void 0,this.timeouts=void 0,this.pingInterval=void 0,this.logging=void 0,this.handleMessage=void 0,this.handleOpen=void 0,this.handleClose=void 0,this.handleReconnect=void 0,this.socketEvents=void 0,this.sagaEffects=[],this._ping=function(e){t.sockets[e].socket.send(g.a),t.timeouts[e]=setTimeout((function(){t.sockets[e].socket.close(4008,"ping_timeout")}),g.d)},this._onPong=function(e){clearTimeout(t.timeouts[e])},this._listen=function(e){var n=t.sockets[e].socket;n.onopen=function(n){t.pingInterval=setInterval((function(){return t._ping(e)}),g.b),t._log(n,e),t.handleOpen(e)},n.onclose=function(n){if(clearInterval(t.pingInterval),console.log(t.sockets),!n.wasClean){var r=t.sockets[e],a=r.token,c=r.uri;setTimeout((function(){return t.connectToSocket(e,a,c)}),1e4)}t.handleClose(e,n.wasClean),t._log(n,e)},n.onmessage=function(n){n.data===g.c?t._onPong(e):(t.handleMessage(e,JSON.parse(n.data)),t._log(n,e))}},this._log=function(e,n){t.logging&&console.log({event:e,state:t.getState(n),socketObj:t.sockets})},this.getState=function(e){return g.n[t.sockets[e].socket.readyState]},this.connectToSocket=function(e,n,r){if(!t.sockets[e]||g.n[t.sockets[e].socket.readyState]!==g.j){var a=new WebSocket("".concat(b.b).concat(r,"?token=").concat(n));t.sockets[e]={token:n,uri:r,socket:a},t._listen(e)}},this.disconnectFromSocket=function(e){console.log(t.sockets),t.sockets[e].socket.close()},this.onOpen=function(e){t.handleOpen=e},this.onReconnect=function(e){t.handleReconnect=e},this.onMessage=function(e){t.handleMessage=e},this.onClose=function(e){t.handleClose=e},this.sockets={},this.timeouts={},this.pingInterval=null,this.logging=!0,this.handleMessage=function(e){return console.log(e)},this.handleOpen=function(e){return console.log(e)},this.handleClose=function(e){return console.log(e)},this.handleReconnect=function(e){return console.log(e)},this.socketEvents={}}return Object(u.a)(e,[{key:"createModule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.initialState,r=t.single;n||(n=r?{item:{}}:{items:[]},n=Object(s.a)(Object(s.a)({},n),{},{waiting:!1})),this.socketEvents[e]={reducer:Object(v.reducerWithInitialState)(n),events:{}}}},{key:"createLocalEvent",value:function(e,t,n){var r=Object(f.actionCreatorFactory)(e)(t);return this.socketEvents[e].reducer.case(r,(function(e,t){return Object(p.a)(e,(function(e){n(e,t)}))})),r}},{key:"createApi",value:function(e,t,n){var r=Object(f.actionCreatorFactory)(e).async(t);this.sagaEffects.push(Object(l.d)(r.started,o.a.mark((function t(a){var c,i,u,d;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(l.c)((function(e){return e.auth.item.token}));case 3:return c=t.sent,t.next=6,Object(l.c)((function(e){var t,n;return null===(t=e.session.item)||void 0===t||null===(n=t.session)||void 0===n?void 0:n.id}));case 6:return i=t.sent,t.next=9,Object(l.a)((function(){return Object(h.apiCaller)(Object(s.a)(Object(s.a)({endpoint:e},n),{},{data:a.payload,token:c,session_id:i}))}));case 9:if(u=t.sent,d=u.result,"2"===u.status.toString()[0]){t.next=17;break}return console.log(d),t.next=16,Object(l.b)(r.failed({params:a.payload,error:d}));case 16:return t.abrupt("return",t.sent);case 17:return t.next=19,Object(l.b)(r.done({params:a.payload,result:d}));case 19:t.next=26;break;case 21:return t.prev=21,t.t0=t.catch(0),console.log(t.t0),t.next=26,Object(l.b)(r.failed({params:a.payload,error:t.t0}));case 26:case"end":return t.stop()}}),t,null,[[0,21]])}))));var a=this.socketEvents[e].reducer;return a.case(r.started,(function(e,t){return Object(p.a)(e,(function(e){e.waiting=!0,e.error=void 0,n.startReducer&&n.startReducer(e,t)}))})),a.case(r.failed,(function(e,t){var r=t.params,a=t.error;return Object(p.a)(e,(function(e){e.waiting=!1,e.error=a,n.failReducer&&n.failReducer(e,a,r)}))})),a.case(r.done,(function(e,t){var r=t.params,a=t.result;return Object(p.a)(e,(function(e){e.waiting=!1,n.successReducer(e,a,r)}))})),function(e){return r.started(e)}}},{key:"createSocketListener",value:function(e,t,n){var r=Object(f.actionCreatorFactory)(e)(t),a=this.socketEvents[e].reducer;this.socketEvents[e].events[t]=r,a.case(r,(function(e,t){return Object(p.a)(e,(function(e){n(e,t)}))}))}},{key:"events",get:function(){return this.socketEvents}},{key:"reducer",get:function(){var e={};return Object.entries(this.socketEvents).forEach((function(t){var n=Object(a.a)(t,2),r=n[0],c=n[1];e[r]=c.reducer})),Object(d.combineReducers)(e)}},{key:"saga",get:function(){var e=this;return o.a.mark((function t(){var n,a,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Object(r.a)(e.sagaEffects),t.prev=1,n.s();case 3:if((a=n.n()).done){t.next=9;break}return c=a.value,t.next=7,c;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,11,14,17]])}))}}]),e}()},96:function(e,t,n){"use strict"},97:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(23),a=n(6);function c(e){return function(t){return function(n){return function(c){var o,s,i;if(c.meta!==a.f)return n(c);switch(o=n(c),c.type){case a.g:e.onOpen((function(e){t.dispatch({type:a.h,meta:a.f,socketDesc:e})})),e.onClose((function(e,n){console.log("closing ",e,n),t.dispatch({type:a.e,meta:a.f,socketDesc:e,wasClean:n})})),e.onMessage((function(e,n){t.dispatch({type:a.k,payload:n,meta:a.f,socketDesc:e})})),e.onReconnect((function(e){t.dispatch({type:a.l,meta:a.f,socketDesc:e})})),e.connectToSocket(c.socketDesc,c.token,c.uri);break;case a.i:console.log("disconecting "),e.disconnectFromSocket(c.socketDesc);break;case a.k:var u=c.payload.type.split("."),l=Object(r.a)(u,2);s=l[0],i=l[1],e.events.hasOwnProperty(s)&&e.events[s].events.hasOwnProperty(i)?t.dispatch(e.events[s].events[i](c.payload.data)):console.warn({module:s,event:i},"does not exist");break;case a.l:t.dispatch({type:a.m,meta:a.f,socketDesc:c.socketDesc})}return o}}}}},98:function(e,t){},99:function(e,t){}},[[138,1,2]]]);
//# sourceMappingURL=main.b2f7607c.chunk.js.map